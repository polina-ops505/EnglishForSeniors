<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Личный кабинет - EnglishForSeniors</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Дополнительные стили для личного кабинета */
        .profile-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        
        .profile-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .profile-card.wide {
            grid-column: span 2;
        }
        
        .user-info p {
            margin: 12px 0;
            font-size: 1.1rem;
        }
        
        .level-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .level-badge.beginner {
            background: #ffeb3b;
            color: #333;
        }
        
        .level-badge.elementary {
            background: #4CAF50;
            color: white;
        }
        
        .level-badge.intermediate {
            background: #2196F3;
            color: white;
        }
        
        .level-badge.advanced {
            background: #9C27B0;
            color: white;
        }
        
        .progress-bar {
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            border-radius: 10px;
            transition: width 0.5s ease;
        }
        
        .stats {
            display: flex;
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat {
            text-align: center;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 10px;
            flex: 1;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #2c3e50;
            display: block;
        }
        
        .achievements {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .achievement {
            padding: 15px;
            background: #f0f0f0;
            border-radius: 10px;
            text-align: center;
            opacity: 0.5;
        }
        
        .achievement.earned {
            background: #4CAF50;
            color: white;
            opacity: 1;
        }
        
        .user-courses {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }
        
        .course-progress {
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #4a6491;
        }
        
        .recommendations {
            list-style: none;
            padding: 0;
        }
        
        .recommendations li {
            padding: 10px;
            margin: 5px 0;
            background: #f0f7ff;
            border-radius: 8px;
        }
        
        .btn-small {
            padding: 8px 20px;
            background: #4a6491;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            margin-top: 10px;
        }
        
        @media (max-width: 768px) {
            .profile-card.wide {
                grid-column: span 1;
            }
            
            .stats {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <h1><i class="fas fa-book-open"></i> EnglishForSeniors</h1>
                <p class="motto">Личный кабинет. "Своя рубашка ближе к телу" - следим за прогрессом!</p>
            </div>
            <nav>
                <a href="index.html">Главная</a>
                <a href="courses.html">Курсы</a>
                <a href="dictionary.html">Словарь</a>
                <a href="profile.html" class="active">Личный кабинет</a>
                <button onclick="logout()" class="btn-login">Выйти</button>
            </nav>
        </div>
    </header>

    <main class="container">
        <div class="profile-header">
            <h1><i class="fas fa-user-circle"></i> Личный кабинет</h1>
            <p class="joke">"Хозяин - барин" своего обучения!</p>
        </div>
        
        <div id="profile-content">
            <div class="loading">
                <p><i class="fas fa-spinner fa-spin"></i> Загрузка данных...</p>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>Проект "Московское Долголетие" <i class="fas fa-heart"></i> 2025</p>
            <p>"Ученье - свет, а неученье - тьма" - продолжайте учиться!</p>
            <p>Проект разработан Толстенёвой Полиной</p>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        // Проверка авторизации
        function checkAuth() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            if (!user) {
                alert('Пожалуйста, войдите в систему');
                window.location.href = 'login.html';
                return null;
            }
            return user;
        }
        
        // Загрузка данных профиля
        function loadProfile() {
            const user = checkAuth();
            if (!user) return;
            
            const profileContent = document.getElementById('profile-content');
            
            // Формируем HTML профиля
            const profileHTML = `
                <div class="profile-grid">
                    <!-- Информация о пользователе -->
                    <div class="profile-card">
                        <h2><i class="fas fa-id-card"></i> Ваш профиль</h2>
                        <div class="user-info">
                            <p><strong>Имя:</strong> ${user.username}</p>
                            <p><strong>Уровень:</strong> 
                                <span class="level-badge ${user.level || 'beginner'}">
                                    ${user.level ? user.level.charAt(0).toUpperCase() + user.level.slice(1) : 'Начинающий'}
                                </span>
                            </p>
                            <p><strong>Возраст:</strong> ${user.age}</p>
                            <p><strong>Район:</strong> ${user.district || 'Не указан'}</p>
                            <p><strong>Дата регистрации:</strong> 
                                ${new Date(user.registered).toLocaleDateString('ru-RU')}
                            </p>
                        </div>
                        <button onclick="editProfile()" class="btn-secondary">
                            <i class="fas fa-edit"></i> Редактировать профиль
                        </button>
                    </div>
                    
                    <!-- Прогресс обучения -->
                    <div class="profile-card">
                        <h2><i class="fas fa-chart-line"></i> Ваш прогресс</h2>
                        <div class="progress-section">
                            <h3>Общий прогресс</h3>
                            <div class="progress-bar">
                                <div class="progress-fill" id="overall-progress" 
                                     style="width: ${calculateProgress(user)}%"></div>
                            </div>
                            <p id="progress-text">${calculateProgress(user)}% выполнено</p>
                            
                            <h3>Выучено слов</h3>
                            <div class="stats">
                                <div class="stat">
                                    <span class="stat-number" id="words-learned">
                                        ${user.learnedWords ? user.learnedWords.length : 0}
                                    </span>
                                    <span class="stat-label">из 150</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-number" id="lessons-completed">
                                        ${user.progress ? Object.keys(user.progress).length : 0}
                                    </span>
                                    <span class="stat-label">уроков</span>
                                </div>
                            </div>
                            
                            <h3>Активность</h3>
                            <p><i class="fas fa-calendar-check"></i> Последний вход: 
                                <span id="last-login">${user.lastLogin ? 'Сегодня' : 'Недавно'}</span>
                            </p>
                            <p><i class="fas fa-clock"></i> Всего времени обучения: 
                                <span id="total-time">${calculateLearningTime(user)} часов</span>
                            </p>
                        </div>
                    </div>
                    
                    <!-- Достижения -->
                    <div class="profile-card">
                        <h2><i class="fas fa-trophy"></i> Достижения</h2>
                        <div class="achievements">
                            <div class="achievement ${user.progress && Object.keys(user.progress).length > 0 ? 'earned' : ''}">
                                <i class="fas fa-star"></i>
                                <span>Первый урок</span>
                            </div>
                            <div class="achievement ${user.learnedWords && user.learnedWords.length >= 10 ? 'earned' : ''}">
                                <i class="fas fa-book"></i>
                                <span>10 слов выучено</span>
                            </div>
                            <div class="achievement">
                                <i class="fas fa-brain"></i>
                                <span>Тест на 100%</span>
                            </div>
                            <div class="achievement">
                                <i class="fas fa-fire"></i>
                                <span>7 дней подряд</span>
                            </div>
                        </div>
                        
                        <div class="joke" style="margin-top: 20px;">
                            <p><i class="fas fa-award"></i> Помните: "Не место красит человека, а человек место" - 
                            и ваши достижения украшают наш сайт!</p>
                        </div>
                    </div>
                    
                    <!-- Курсы пользователя -->
                    <div class="profile-card wide">
                        <h2><i class="fas fa-graduation-cap"></i> Ваши курсы</h2>
                        <div class="user-courses">
                            <div class="course-progress">
                                <h3>Начальный уровень</h3>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${user.progress && user.progress['beginner'] ? user.progress['beginner'].completedLessons * 10 : 0}%"></div>
                                </div>
                                <p>${user.progress && user.progress['beginner'] ? user.progress['beginner'].completedLessons : 0} из 10 уроков завершено</p>
                                <a href="course-beginner.html" class="btn-small">${user.progress && user.progress['beginner'] ? 'Продолжить' : 'Начать'}</a>
                            </div>
                            
                            <div class="course-progress">
                                <h3>Средний уровень</h3>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${user.progress && user.progress['elementary'] ? user.progress['elementary'].completedLessons * 10 : 0}%"></div>
                                </div>
                                <p>${user.progress && user.progress['elementary'] ? user.progress['elementary'].completedLessons : 0} из 10 уроков завершено</p>
                                <a href="courses.html" class="btn-small">${user.level === 'elementary' || user.level === 'intermediate' || user.level === 'advanced' ? 'Продолжить' : 'Начать'}</a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Рекомендации -->
                    <div class="profile-card">
                        <h2><i class="fas fa-lightbulb"></i> Рекомендации</h2>
                        <ul class="recommendations">
                            ${generateRecommendations(user)}
                        </ul>
                        
                        <div class="motivation">
                            <p><i class="fas fa-comment-dots"></i> "Кто хочет, тот добьётся!" - продолжайте в том же духе!</p>
                        </div>
                    </div>
                </div>
            `;
            
            profileContent.innerHTML = profileHTML;
        }
        
        // Расчет прогресса
        function calculateProgress(user) {
            if (!user.progress) return 0;
            
            const totalLessons = 30; // 3 курса × 10 уроков
            const completedLessons = Object.values(user.progress).reduce((sum, course) => {
                return sum + (course.completedLessons || 0);
            }, 0);
            
            return Math.round((completedLessons / totalLessons) * 100);
        }
        
        // Расчет времени обучения
        function calculateLearningTime(user) {
            if (!user.progress) return 0;
            
            let totalTime = 0;
            Object.values(user.progress).forEach(course => {
                totalTime += (course.completedLessons || 0) * 0.5; // Предполагаем 30 минут на урок
            });
            
            return Math.round(totalTime);
        }
        
        // Генерация рекомендаций
        function generateRecommendations(user) {
            const recommendations = [];
            
            if (!user.level) {
                recommendations.push('<li><i class="fas fa-check-circle"></i> Пройдите тест на определение уровня</li>');
            }
            
            if (!user.progress || Object.keys(user.progress).length === 0) {
                recommendations.push('<li><i class="fas fa-check-circle"></i> Начните первый урок начального курса</li>');
            }
            
            if (user.learnedWords && user.learnedWords.length < 10) {
                recommendations.push('<li><i class="fas fa-check-circle"></i> Выучите 10 новых слов</li>');
            }
            
            if (recommendations.length === 0) {
                recommendations.push('<li><i class="fas fa-check-circle"></i> Продолжайте следующий урок</li>');
                recommendations.push('<li><i class="fas fa-check-circle"></i> Повторите пройденные слова</li>');
            }
            
            return recommendations.join('');
        }
        
        // Редактирование профиля
        function editProfile() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            
            const newName = prompt('Введите новое имя:', user.username);
            if (newName && newName.trim() !== '') {
                user.username = newName.trim();
                
                // Сохраняем изменения
                localStorage.setItem('currentUser', JSON.stringify(user));
                
                // Обновляем в массиве пользователей
                const users = JSON.parse(localStorage.getItem('users')) || [];
                const index = users.findIndex(u => u.id === user.id);
                if (index !== -1) {
                    users[index] = user;
                    localStorage.setItem('users', JSON.stringify(users));
                }
                
                alert('Имя успешно изменено!');
                loadProfile();
            }
        }
        
        // Выход
        function logout() {
            if (confirm('Вы уверены, что хотите выйти?')) {
                localStorage.removeItem('currentUser');
                window.location.href = 'index.html';
            }
        }
        
        // Загружаем профиль при загрузке страницы
        document.addEventListener('DOMContentLoaded', loadProfile);
    </script>
<script src="script.js"></script>
</body>
</html>